# RAG Chat Storage Microservice

A production-ready backend microservice for storing and managing chat histories generated by a RAG (Retrieval-Augmented Generation) chatbot system.

## Features
- Store and manage chat sessions and messages
- Rename, favorite, and delete chat sessions
- Retrieve message history with pagination
- API key authentication and rate limiting
- Centralized logging and global error handling
- CORS configuration
- Dockerized setup (app, PostgreSQL, pgAdmin)
- Swagger/OpenAPI API documentation
- Health check endpoint
- Example unit tests

## Getting Started

### Prerequisites
- Docker & Docker Compose
- Java 17 (for local development without Docker)

### Setup
1. Copy `.env.example` to `.env` and adjust values as needed.
2. Build and start all services:
   ```sh
   docker-compose up --build
   ```
3. The API will be available at `http://localhost:8080`.
4. Swagger UI: `http://localhost:8081/swagger-ui/index.html`
5. pgAdmin: `http://localhost:5050` (login: admin@admin.com / admin)

### Environment Variables
See `.env.example` for all required variables:
- `SPRING_DATASOURCE_URL`, `SPRING_DATASOURCE_USERNAME`, `SPRING_DATASOURCE_PASSWORD`
- `API_KEY` (required for all API requests)
- `RATE_LIMIT` (requests per minute per IP)
- `CORS_ALLOWED_ORIGINS`

### API Authentication
All endpoints (except `/health` and Swagger docs) require an `X-API-KEY` header with the value set in your `.env` file.

### API Endpoints
- `POST /sessions` – Create a new chat session
- `GET /sessions` – List sessions (filter by favorite, pagination planned)
- `PATCH /sessions/{id}/rename` – Rename session
- `PATCH /sessions/{id}/favorite` – Mark/unmark as favorite
- `DELETE /sessions/{id}` – Delete session and its messages
- `POST /sessions/{id}/messages` – Add message to session
- `GET /sessions/{id}/messages` – Get messages (with pagination)
- `GET /health` – Health check

See Swagger UI for full request/response details.


